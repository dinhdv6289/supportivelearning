<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <title>eLearning</title>
    </h:head>
    <h:body>

        <h:form prependId="false">
            <a href="#{request.contextPath}new.xhtml"/>
            <p:growl id="messages" showDetail="true" />
            <c:set var="studentSelect" value="#{studentBean.studentSelected}"/>
            <p:dataTable value="#{studentBean.students}" var="student" emptyMessage="No students"  paginator="true" rows="10">
                <p:column filterBy="#{student.course.name}" sortBy="#{student.course.name}" 
                          headerText="Course" 
                          filterMatchMode="contains">
                    <h:outputText value="#{student.course.name}" />

                </p:column>  
                <p:column filterBy="#{student.clazz.name}" sortBy="#{student.clazz.name}" 
                          headerText="Class">
                    <h:outputText value="#{student.clazz.name}" />

                </p:column>                    
                <p:column filterBy="#{student.name}" sortBy="#{student.name}"
                          headerText="Name" >
                    <h:outputText value="#{student.name}" />
                </p:column>

                <p:column headerText="Actions">
                    <p:commandButton
                        action="#{studentBean.onRequestStudent(studentSelect)}"
                        update="displayEdit"
                        onclick="editStudentDialog.show()"
                        image="ui-icon ui-icon-edit">

                    </p:commandButton>
                    <p:commandButton 
                        update="display" oncomplete="studentDialog.show()"
                        image="ui-icon ui-icon-search">
                        <f:setPropertyActionListener value="#{student}"
                                                     target="#{studentBean.studentSelected}" />
                    </p:commandButton>
                    <p:commandButton  value="Delete" onclick="confirmDelete.show()" type="button"/>
                    
                </p:column>
            </p:dataTable>

            <p:dialog header="Edit Student" widgetVar="editStudentDialog" resizable="false"
                      width="400" showEffect="explode" hideEffect="explode">

                <h:panelGrid id="displayEdit" columns="2" cellpadding="4">
                    <h:outputText value="Course:" />
                    <p:inputText value="#{studentBean.studentSelected.course.name}" />

                    <h:outputText value="Class:" />
                    <p:inputText value="#{studentBean.studentSelected.clazz.name}" />

                    <h:outputText value="Name:" />
                    <p:inputText value="#{studentBean.studentSelected.name}" />
                    <p:commandButton value="Update" actionListener="#{studentBean.editStudent}"  update="messages" oncomplete="editStudentDialog.hide()"/>


                </h:panelGrid>

            </p:dialog>

            <p:dialog header="Student Detail" widgetVar="studentDialog" resizable="false"
                      width="400" showEffect="explode" hideEffect="explode">
                <h:panelGrid id="display" columns="2" cellpadding="4">
                    <h:outputText value="Course:" />
                    <h:outputText value="#{studentBean.studentSelected.course.name}" />

                    <h:outputText value="Class:" />
                    <h:outputText value="#{studentBean.studentSelected.clazz.name}" />

                    <h:outputText value="Name:" />
                    <h:outputText value="#{studentBean.studentSelected.name}" />
                    <p:commandButton value="Close"  onclick="studentDialog.hide()"/>
                </h:panelGrid>
            </p:dialog>

            <p:confirmDialog widgetVar="confirmDelete" message="Are you sure?"
                             showEffect="bounce" hideEffect="explode"
                             header="Initiating delete process" severity="alert">
                <p:commandButton  actionListener="#{studentBean.deleteStudent}" update="messages" value="Delete" oncomplete="confirmDelete.hide()"/>
                <p:commandButton  onclick="confirmDelete.hide()" type="button" value="Cancel"/>

            </p:confirmDialog>

        </h:form>
    </h:body>
</html>

